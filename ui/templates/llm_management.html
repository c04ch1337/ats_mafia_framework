<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Management - ATS MAFIA Framework</title>
    <link rel="stylesheet" href="../css/mafia_theme.css">
    <link rel="stylesheet" href="../css/tools.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="mafia-theme">
    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="framework-title">ATS MAFIA</h1>
                <p class="framework-subtitle">LLM Management</p>
            </div>

            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="../templates/dashboard.html" class="nav-link">
                            <span class="nav-icon">ðŸ“Š</span>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../templates/scenarios.html" class="nav-link">
                            <span class="nav-icon">ðŸŽ¯</span>
                            <span class="nav-text">Scenarios</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../templates/tools.html" class="nav-link">
                            <span class="nav-icon">ðŸ”§</span>
                            <span class="nav-text">Tools</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="../templates/llm_management.html" class="nav-link">
                            <span class="nav-icon">ðŸ§ </span>
                            <span class="nav-text">LLM Models</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="../templates/analytics.html" class="nav-link">
                            <span class="nav-icon">ðŸ“ˆ</span>
                            <span class="nav-text">Analytics</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h2 class="page-title">LLM Model Management</h2>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="refreshModelsBtn">
                        <span>ðŸ”„</span> Refresh
                    </button>
                    <button class="btn btn-primary" id="recommendModelBtn">
                        <span>âœ¨</span> Get Recommendation
                    </button>
                </div>
            </header>

            <!-- Cost Overview Dashboard -->
            <div class="cost-overview-section">
                <h3 class="section-title">Cost Overview</h3>
                <div class="cost-dashboard">
                    <div class="cost-card">
                        <div class="cost-card-header">
                            <span class="cost-icon">ðŸ’°</span>
                            <h4>Total Spend</h4>
                        </div>
                        <div class="cost-value" id="totalSpend">$0.00</div>
                        <div class="cost-period">This Month</div>
                    </div>

                    <div class="cost-card">
                        <div class="cost-card-header">
                            <span class="cost-icon">ðŸ“Š</span>
                            <h4>Average per Session</h4>
                        </div>
                        <div class="cost-value" id="avgSessionCost">$0.00</div>
                        <div class="cost-period">Last 30 Days</div>
                    </div>

                    <div class="cost-card">
                        <div class="cost-card-header">
                            <span class="cost-icon">âš¡</span>
                            <h4>Tokens Used</h4>
                        </div>
                        <div class="cost-value" id="tokensUsed">0</div>
                        <div class="cost-period">This Month</div>
                    </div>

                    <div class="cost-card">
                        <div class="cost-card-header">
                            <span class="cost-icon">ðŸŽ¯</span>
                            <h4>Budget Remaining</h4>
                        </div>
                        <div class="cost-value" id="budgetRemaining">$0.00</div>
                        <div class="cost-period">
                            <div class="budget-bar">
                                <div class="budget-fill" id="budgetFill" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Cost Chart -->
            <div class="chart-section">
                <div class="chart-header">
                    <h3>Cost Trend</h3>
                    <select id="costPeriodFilter" class="filter-select">
                        <option value="7d">Last 7 Days</option>
                        <option value="30d" selected>Last 30 Days</option>
                        <option value="90d">Last 90 Days</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="costChart"></canvas>
                </div>
            </div>

            <!-- Model Browser -->
            <div class="models-section">
                <div class="section-header">
                    <h3>Available Models</h3>
                    <div class="model-filters">
                        <select id="providerFilter" class="filter-select">
                            <option value="all">All Providers</option>
                            <option value="openai">OpenAI</option>
                            <option value="anthropic">Anthropic</option>
                            <option value="google">Google</option>
                        </select>
                        <select id="capabilityFilter" class="filter-select">
                            <option value="all">All Capabilities</option>
                            <option value="coding">Coding</option>
                            <option value="reasoning">Reasoning</option>
                            <option value="creative">Creative</option>
                            <option value="analysis">Analysis</option>
                        </select>
                    </div>
                </div>

                <div class="models-grid" id="modelsGrid">
                    <!-- Models will be dynamically loaded here -->
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                        <p>Loading models...</p>
                    </div>
                </div>
            </div>

            <!-- Model Comparison -->
            <div class="comparison-section">
                <div class="section-header">
                    <h3>Model Comparison</h3>
                    <button class="btn btn-sm btn-secondary" id="clearComparisonBtn">Clear Selection</button>
                </div>
                <div id="comparisonContainer">
                    <p class="empty-state">Select models to compare their features and costs</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Model Details Modal -->
    <div class="modal-overlay" id="modelDetailsModal">
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h3 class="modal-title" id="modelDetailTitle">Model Details</h3>
                <button class="modal-close" id="closeModelDetailsModal">&times;</button>
            </div>
            <div class="modal-body" id="modelDetailContent">
                <!-- Model details will be loaded here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="closeModelDetailsBtn">Close</button>
                <button class="btn btn-primary" id="selectModelBtn">Select for Session</button>
            </div>
        </div>
    </div>

    <!-- Budget Configuration Modal -->
    <div class="modal-overlay" id="budgetConfigModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Configure Budget</h3>
                <button class="modal-close" id="closeBudgetModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="budgetConfigForm">
                    <div class="form-group">
                        <label for="monthlyBudget">Monthly Budget (USD)</label>
                        <input type="number" id="monthlyBudget" class="form-control" step="1" min="0" value="100">
                    </div>

                    <div class="form-group">
                        <label for="sessionBudget">Default Session Budget (USD)</label>
                        <input type="number" id="sessionBudget" class="form-control" step="0.1" min="0" value="10">
                    </div>

                    <div class="form-group">
                        <label for="alertThreshold">Budget Alert Threshold (%)</label>
                        <input type="number" id="alertThreshold" class="form-control" min="0" max="100" value="80">
                        <small class="form-help">Alert when reaching this percentage of budget</small>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoStop">
                            Automatically stop sessions when budget exceeded
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelBudgetBtn">Cancel</button>
                <button class="btn btn-primary" id="saveBudgetBtn">Save Configuration</button>
            </div>
        </div>
    </div>

    <!-- Recommendation Modal -->
    <div class="modal-overlay" id="recommendationModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">Get Model Recommendation</h3>
                <button class="modal-close" id="closeRecommendationModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="recommendationForm">
                    <div class="form-group">
                        <label for="taskType">Task Type</label>
                        <select id="taskType" class="form-control" required>
                            <option value="">-- Select Task Type --</option>
                            <option value="coding">Coding & Development</option>
                            <option value="analysis">Data Analysis</option>
                            <option value="reasoning">Complex Reasoning</option>
                            <option value="creative">Creative Writing</option>
                            <option value="conversation">Conversation</option>
                            <option value="penetration-testing">Penetration Testing</option>
                            <option value="social-engineering">Social Engineering</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="priorityFactor">Priority</label>
                        <select id="priorityFactor" class="form-control">
                            <option value="cost">Lowest Cost</option>
                            <option value="performance">Best Performance</option>
                            <option value="balanced" selected>Balanced</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="maxBudget">Max Budget per Session (USD)</label>
                        <input type="number" id="maxBudget" class="form-control" step="1" min="1" value="10">
                    </div>
                </form>

                <div id="recommendationResult" style="display: none;">
                    <h4>Recommended Model:</h4>
                    <div id="recommendedModelCard"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelRecommendationBtn">Cancel</button>
                <button class="btn btn-primary" id="getRecommendationBtn">Get Recommendation</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/api-client.js"></script>
    <script src="../js/llm_controller.js"></script>
    <script>
        // Initialize LLM controller when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            window.llmController = new LLMController();
        });
    </script>
</body>
</html>